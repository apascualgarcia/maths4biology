
\section{Integrals}

\subsection{Integral Calculus: Definite Integrals}
How do you determine the area $A$ enclosed by a function $f(x)$
and the horizontal axis. It is simple if $f(x)=f_0=const$. \vs
\begin{figure}[!h]
    \centerline{\epsfxsize=12cm \epsfbox{matlab/fig20.eps}}
    \caption{Area $A$ enclosed by the horizontal axis and a horizontal line.} \label{fig22}
\end{figure} \vs

For the general case, divide the area $A$ into subareas
$A_{\nu}$ between $x_{\nu-1}$ and $x_{\nu}$. \vs
\begin{figure}[!h]
    \centerline{\epsfxsize=12cm  \epsfbox{matlab/fig21.eps}}
    \caption{Area enclosed by the function $f(x)$ and the horizontal axis.} \label{fig23}
\end{figure} \vs

Then the subarea $A_{\nu}$ may be approximated by
$A_{\nu}=f(\xi_{\nu}) ( x_{\nu}-x_{\nu-1} )$ for $x_{\nu-1}<\xi_{\nu}<x_{\nu}$.
There exists always a $\xi_{\nu}$ such that this is true.

Reconstruct the area $A$ as follows:
\bnn
A=\sum_{\nu=1}^N=A_{\nu}=\sum_{\nu=1}^N f(\xi_{\nu})\underbrace{(x_{\nu} - x_{\nu-1})}_{\Delta x}
\enn

This sum is called the {\em Riemann sum}. For instance, for $N=3$ the sum becomes

\bnn
A=f(\xi_1)(x_1-x_0)+f(\xi_2)(x_2-x_1)+f(\xi_3)(x_3-x_2),
\enn
but, if we take few terms, our approximation to the area will be poor. However, we know already
how to take limits, so we can take the limit of the Riemann sum, and hence the area $A$ will
be computed precisely, and it will allow us to define the integral.

\bnn
A=\underset{N\rightarrow\infty}{\lim} \sum_{\nu=1}^N f(\xi_{\nu})\Delta x=\int_{x=a}^{x=b} \: f(x)\: dx
\enn

The area enclosed by $f(x)$ and the horizontal $x$-axis over an interval $x \in [a,b]$ is given by
definite integral
\bnn 
\int_a^b \: f(x)\, dx= F(x)\! \left.\frac{}{}\right|_{x=a}^{x=b} \,
= F(x)\! \left.\frac{}{}\right|_a^b \,= F(b)-F(a) 
\enn

where $F(x)$ is called the {\em anti-derivative} of $f(x)$ and
\bnn f(x) = \frac{dF(x)}{dx} = F'(x) \qquad\mbox{or, which is equivalent,}\qquad F(x)=\int \: f(x)\, dx+\mbox{const} \enn
Integration is to some extend the inverse operation of differentiation. \vs

{\bf Example:} Try to guess the area under $f(x)=x^2$ within the interval $[-1,1]$.

\svs\begin{figure}[!h]
    \centering
    \subfigure[Definite integral of $y=x^2$]{\epsfxsize=7cm \epsfbox{matlab/fig22a.eps}}
    \hspace*{0.5cm}
    \subfigure[Definite integral of $y=x^3$]{\epsfxsize=7cm  \epsfbox{matlab/fig22b.eps}} \svs
    \caption{Definite integrals as areas under curves}  \label{fig24}
\end{figure} \svs

\begin{description}
\item[{\bf a)}]
Looking at Fig. \ref{fig24}, the shaded area is given by
\bnn A=\int_{-1}^1 f(x)\,dx= F(1)-F(-1) \enn

In order to guess a solution, remember that we know that $f(x)=x^2=F'(x)$. Therefore, we guess $F(x)=1/3x^3+c$, and the are becomes:

\bnn A= F(1)-F(-1)=\frac{1}{3} 1^3 + c - \{ \frac{1}{3} (-1)^3 + c \} = \frac{2}{3} \enn \vs

{\bf Example:} Try to guess the area under $f(x)=x^3$ within the interval $[-1,1]$.

\item[{\bf b)}]
Again, the shaded area shown in Fig. \ref{fig24} is given by
\bnn A=\int_{-1}^1 f(x)\,dx=F(1)-F(-1)\enn
We guess $F(x)=\frac{1}{4}x^4+c$ and find
\bnn A=\int_{-1}^1 f(x)\,dx=F(1)-F(-1) = \frac{1}{4}1^4 + c - \{ \frac{1}{4} (-1)^4 + c \} =0 \enn

Why does the area $A$ vanish? It actually consists of two areas, $A_1$ and $A_2$, which both have
the same size, but opposite sign $A_1=-A_2$.
\bnn A_1=F(0)-F(-1)=\frac{1}{4}0^4+c - \frac{1}{4}(-1)^4-c=-\frac{1}{4}=-A_2 \enn
\end{description}

{\bf Note:} In an integral the area {\em below} the x-axis is counted negative. In order to calculate the shaded area
we have to evaluate all pieces between intersections of the curve with the horizontal axis separately and add up their
magnitudes. Here: $A=\abs{A_1}+\abs{A_2}=\abs{-\frac{1}{4}}+\abs{\frac{1}{4}}=\frac{1}{2}$. \vs

\subsection{Indefinite integral}

We say that $F(x)$ is the primitive function or antiderivative if $F'(x)=f(x)$ for all the
domain of $f$.

\subsubsection{Polynomials}
\bnn
 \int x^p dx = \frac{x^{p+1}}{p+1}+C\quad \mbox{for }p \neq -1
\enn

\subsubsection{Logarithms}
\bnn
\int \frac{1}{x}dx = \log |x| +C
\enn

\subsubsection{Exponential functions}
\bnn
\int e^x dx = e^x +C; \quad	\int f'(x) e^f(x) dx = e^f(x) +C
\enn

\subsubsection{Trigonometric functions}
\bnn
\int \sin x dx = -\cos x +C
\enn

\bnn
\int \cos x dx = \sin x + C
\enn

\bnn
\int \sec^2 x dx = \int \frac{dx}{\cos^2x} = \int (1+\tan^2 x) dx = \tan x +C
\enn

\bnn
\int \csc^2 x dx = \int \frac{dx}{\sin^2x} = \int (1+\cot^2 x) dx = -\cot x +C
\enn

The following three are particularly important:

\bnn
\int \frac{dx}{1+x^2}=\arctan x +C
\enn
\bnn
\int -\frac{dx}{\sqrt{1-x^2}}=\arccos x +C
\enn
\bnn
\int \frac{dx}{\sqrt{1+x^2}}=\arcsin x +C
\enn

{\bf Note:} How did you end up with these last expressions? Let's see one example:

\bnn
y=\arcsin x \quad \rightarrow \sin y = x \quad \underbrace{\rightarrow}_{\mbox{Differentiate}} y'\cos y =1 \\
y' =\frac{1}{\cos y} \underbrace{=}_{\sin^2 y+ \cos^2 y =1 } \frac{1}{\sqrt{1-\sin^2 y}} = \frac{1}{\sqrt{1-x^2}}.
\enn

\subsubsection{Hyperbolic functions}

\bnn
\int \sinh x dx = \cosh x + C
\enn

\bnn
\int \cosh x dx = \sinh x + C
\enn

\subsection{Properties of integrals}

\bnn \int_a^b f(x) \,dx = \int_a^c f(x) \:dx + \int_c^b f(x) \,dx \enn
\bnn \int_a^b f(x) \,dx = F(b)-F(a)=-(F(a)-F(b))=- \int_b^a f(x) \,dx \enn
\bnn \int_a^b (f_1(x)+f_2(x)) \:dx = \int_a^b \: f_1(x) \,dx + \int_a^b f(x)_2\,dx \enn
\bnn \int_a^b  c \, f(x) \,dx=c \,\int_a^b f(x) \,dx \qquad \mbox{where $c$ is a constant} \enn \vs


\subsection{Methods of Integration}

\subsubsection{Guess and tables}
Find $F(x)$ such that $\frac{dF(x)}{dx} = f(x)$. For polynomials: $F(a\,x^n)=\frac{a}{n+1}\,x^{n+1}$.
\vspace*{2mm} \\ Note: Here $n$ can be negative or any rational number except -1. \\
%\item {\bf Tables:} 
$F(x)$ may be also looked up in mathematical tables of anti-derivatives and/or definite integrals.
%which can be found in e.g. Bronshteyn, Semendjajew or Gradsteyn.\\

\subsubsection{Substitution}

We find an integral containing a function multiplying something that looks
like its derivative. It is somehow the counterpart of the chain rule. 

{\bf Example: } Let's start taking the derivatives of a nested function, $v(u(x))$, such as $e^2x$.

\bnn
 \frac{dv(u(x))}{dx}=\frac{d(e^{x^2})}{dx}=\frac{dv}{du}\frac{du}{dx}=e^{x^2}2x \quad \rightarrow \int e^{\overbrace{x^2}^u}\underbrace{2xdx}_{du}\\ 
 \rightarrow \int e^u du = e^u +C \rightarrow e^{x^2}+C.
\enn 

A little bit more general, considering also the integral boundaries.
\bnn
\int_{x=a}^{x=b} v(u(x)) \, u'(x)\, dx = \int_{u=u(a)}^{u=u(b)} v(u)\, du 
\enn 

{\bf Example:} Solve the integral:

\begin{eqnarray*}
%\begin{array}{cl}
\int x\sqrt{1-x^2}dx  \underbrace{=}_{\uparrow}& \\
 \mbox{{\small change of vars:}} & \begin{cases} z=1-x^2 \\
 \frac{dz}{dx}=-2x \rightarrow xdx = -\frac{1}{2}dz. \end{cases}\\
 = -\frac{1}{2}\int z^{1/2}dz = &-\frac{1}{2}\frac{2}{3}z^{\frac{3}{2}}+C=-\frac{1}{3}(1-x^2)^{\frac{3}{2}}+C. 
% \end{array}
\end{eqnarray*}

{\bf Example:} Solve the integral:

\begin{eqnarray*}
%\begin{array}{rcl}
\int \frac{\cos x}{2-3\sin x}dx\underbrace{=}_{\uparrow}&  \\ 
\mbox{{\small (change of vars.)}} &\begin{cases} z= \sin x \\ \frac{dz}{dx}=\cos x \rightarrow dx \cos x = dz\end{cases} \\
\\
=\int \frac{dz}{2-3z} \underbrace{=}_{\uparrow}&  \\
\mbox{{\small (2nd change of vars.)}} & \begin{cases} u = 2-3z \\ \frac{du}{dz}=-3 \rightarrow dz = \frac{-du}{3} \end{cases} \\
\\
=-\frac{1}{3} \int \frac{du}{u} = \frac{1}{3}\log |u|+C &=  -\frac{1}{3}\log |2-3z|+C  =-\frac{1}{3}\log |3-3\sin x|+C 
%\end{array}
\end{eqnarray*}

{\bf Example:} Solve the integral:

\begin{eqnarray*}
%\begin{array}{rl}
\int_0^{\pi} \cos^2 x \; \sin x \, dx \underbrace{=}_{\uparrow} -\int_{x=0}^{x=\pi} u^2 \,du   \\
\quad \quad {\mbox{\small change of vars.}}  \begin{cases} u = \cos x \\ \frac{du}{dx}=-\sin x \rightarrow \sin x dx = -du \end{cases} \\
%\end{array}
\end{eqnarray*}

%\vs
%\bnn \int_0^{\pi} \cos^2 x \; \sin x \, dx \quad \mbox{substitute:} \quad u=\cos x=\phi(x) \enn \vs
%\bnn
%  u'=\frac{du}{dx}=-\sin x = \phi'(x) \quad \rightarrow \quad
%  du = -\sin x dx = \phi'(x) dx \quad \rightarrow\quad dx = -\frac{du}{\sin x}
%\enn \vs
%
%Substitute the integral:
%\bnn
%\int_{x=0}^{x=\pi} \cos^2 x \; \sin x \, \frac{-du}{\sin x}=-\int_{x=0}^{x=\pi} \cos^2 x \,du=-\int_{x=0}^{x=\pi} u^2 \,du
%\enn \vs

Since it is a definite integral, we should express the boundaries in terms of $u$:
\bnn x=0 \quad \rightarrow\quad u=\cos 0=1 \qquad\qquad\qquad\qquad x=\pi \quad \rightarrow\quad u=\cos \pi =-1 \enn \svs

Insert them and perform the integration:
\bnn
\int_0^{\pi} \cos^2 x \; \sin x \, dx
   =-\int_{u=1}^{u=-1} u^2 \, du = -\frac{1}{3}u^3 \! \left.\frac{}{}\right|_1^{-1} 
   = -\frac{1}{3}(-1)^3 + \frac{1}{3}1^3=\frac{2}{3}
\enn
%\end{itemize} \vs

\subsubsection{Partial integration}
Corresponds to the product rule but only works for special cases.
\bnn 
\int \underbrace{g(x)}_{u}\, \underbrace{f(x)dx}_{dv} = \underbrace{g(x)}_{u}\, \underbrace{F(x)}_{v}-\int \: \underbrace{F(x)}_{v}\, \underbrace{g'(x)\,dx}_{du} \\
\int u dv = uv - \int v du 
\enn

{\bf Memo:} {\LARGE {\bf S}}usan {\bf U}ses a {\bf D}e{\bf V}ice = {\bf V}ery {\bf U}nique -{\LARGE{\bf S}}ince {\bf V}isualizes the {\bf D}eep {\bf U}niverse.

Typically, we will have the products of two functions, one of which is easy to differentiate (logarithms, polynomials, $\arccos$-like functions) that will be $u$, and another one that is easy to integrate
such as polynomials or $\sin$-like functions, will be $v$. 

{\bf Example:} Solve the definite integral.

\bnn
I=\int_a^b \underbrace{x}_{u}\, \underbrace{\cosh x \, dx}_{dv}
\enn

Again, we find $v$ and $du$, respectively:

\bnn
u=x \quad \rightarrow  du/dx=1 \\
dv=\cosh x \, dx \quad \rightarrow v = \int \cosh x \, dx = \sinh x.
\enn

Now we substitute using the memo, be aware that the integral is definite!
\bnn
I =  x \sinh x \arrowvert_a^b -  \int_a^b \sinh x dx = \\
  = b\sinh b - a \sinh a - (\cosh b - \cosh a).
\enn \svs

{\bf Example:} Solve the indefinite integral

\bnn
I=\int \underbrace{\arccot x}_{u} \underbrace{dx}_{dv}
\enn

First of all, to apply the memo we need to find $du$ and $v$:

\bnn
u = \arccot x \quad \rightarrow du=\frac{1}{1+x^2}dx\\
dv = 1·dx \quad \rightarrow v = \int dx = x.
\enn

Then, we get

\bnn
I=x \arccot x - \underbrace{\int \frac{x}{1+x^2}dx}_{\mbox{by substitution}} =
=x \arccot x + \frac{1}{2}\log (1+x^2) +C.
\enn

{\bf Example:} Solve the indefinite integral:

%\bnn
\begin{eqnarray*}
I = \underbrace{\int x^3 e^x dx} &  \\
\mbox{change vars.}& \begin{cases} 
   u=x^3 \quad \rightarrow du=3x^2 dx\\
   dv = e^x dx  \quad \rightarrow  v= e^x 
\end{cases}  \\
\end{eqnarray*}
%\enn
Substitute and repeat the procedure, because the new integral should be solved similarly:
\begin{eqnarray*}
I = x^3 e^x - \underbrace{\int 3x^2 e^x dx} &  \\
\mbox{change vars.}& \begin{cases} 
   u=3x^2 \quad \rightarrow du=6x dx\\
   dv = e^x dx  \quad \rightarrow  v= e^x 
\end{cases}  \\
\end{eqnarray*}

And once more!
\begin{eqnarray*}
I = x^3 e^x -(3x^2 e^x - \underbrace{\int 6x e^x dx}) &  \\
\mbox{change vars.}& \begin{cases} 
   u=6x \quad \rightarrow du=6 dx\\
   dv = e^x dx  \quad \rightarrow  v= e^x 
\end{cases}  \\
\end{eqnarray*}

And, finally, the last integral is immediate:

\bnn
I = x^3 e^x -(3x^2 e^x - (6x e^x - \underbrace{\int 6 e^x dx}_{\mbox{immediate}})) &  \\
  =e^x(x^3-3x^2+6x-6)+C.
\enn




\subsection{Symmetries}
A function $f(x)$ is called an {\em even function} if $f(-x)=f(x)$; a function $g(x)$ is called an {\em odd function}
if $g(-x)=-g(x)$. The product of two even functions or the product of two odd functions is an even function; the product
of an odd and an even function is an odd function.

The integral over a symmetric interval around $x=0$ of an odd function vanishes.
 
\bnn 
\int_{-a}^{b=a} g(x) \, dx = \int_{-a}^{b=a} f(x) \, g(x) \: dx = 0 \qquad
\mbox{if} \;\; f(-x)=f(x) \quad \mbox{and} \quad g(-x)=-g(x) 
\enn

{\bf Example:}
\bnn \int_{-1}^1 \underbrace{x^2}_{f(x)} \underbrace{\sin 3x}_{g(x)}\: dx= 0 \enn

\begin{figure}[!h]
    \centerline{\epsfxsize=12cm \epsfysize=8cm  \epsfbox{matlab/fig23.eps}} \svs
    \caption{Due to symmetry the integral $\; \int_{-1}^1 x^2 \, \sin 3x\:dx\;$ vanishes} \label{fig26}
\end{figure} \vs \svs

\subsection{Orthogonality of trigonometric functions}
The cosine is an even function $\cos (-x)=\cos x$, and the sine is an odd function \mbox{$\sin(-x)=-\sin x$.}
Moreover, these trigonometric functions are $2\pi$-periodic, hence it is sufficient to consider integration
over windows of $2\pi$ only.
\bnn
\int_0^{2\pi}\underbrace{\sin x \, \cos x}_{\frac{1}{2}\sin 2x} \, dx
    = \frac{1}{2} \int_0^{2\pi}\sin 2x \, dx = -1/4\cos 2x \! \left.\frac{}{}\right|_0^{2\pi} = 0 \quad \mbox{or equivalent:} \;\;
     \int_{-\pi}^{\pi} \sin x \, \cos x\, dx = 0
\enn

\bnn
\int_{-\pi}^{\pi} \sin 2x \, \sin x \, dx = 2\int_{-\pi}^{\pi} \underbrace{\sin^2 x}_{u^2} \; \underbrace{\cos x \, dx}_{du}
    = 2 \int_{u=0}^{u=0} u^2 \: du = 0
\enn
Here we used the substitution $u=\sin x$ and $du=\cos x \, dx$ with the boundaries $x=\pi \rightarrow u=0$
and $x=-\pi \rightarrow u=0$. \svs

{\bf More general cases:}
\bnn \int_{-\pi}^{\pi} \cos mx \, \cos nx \, dx=\int_{-\pi}^{\pi} \sin mx \, \sin nx \, dx = \pi \, \delta_{mn} \enn
\bnn \int_{-\pi}^{\pi} \cos mx \sin nx \, dx = 0 \;\; \forall \;\; m,\,n \qquad\mbox{where "$\forall$" means "for all"} \enn

$\delta_{mn}$ is called the {\em Kronecker delta} which is defined as $\delta_{mn}=1$ if $m=n$ and $\delta_{mn}=0$ else.

\subsection{Integrals to Infinity}
If one or both boundaries of an integral are infinite this does not mean that the area under this curve
cannot be finite. A trivial example is given by the integral from $-\infty$ to $+\infty$ over an odd function.
This integral vanishes, as seen above, independent of the function as long as it is odd.

A nontrivial example is 
\bnn 
\int_1^{\infty} \frac{1}{x^2} \; dx = - \left. \frac{-1}{x} \right|_1^{\infty} 
    = -( \underbrace{\frac{1}{\infty}}_{=0} - \frac{1}{1}) = 1 
\enn
however
\bnn
\int_1^{\infty} \frac{1}{x} \; dx = \ln x \left. \frac{}{} \! \right|_1^{\infty} 
    = \ln \infty - \underbrace{\ln 1}_{=0} = \infty 
\enn \svs

In the same way even if a function has a singularity like $\frac{1}{\sqrt{x}}$ for $x \rightarrow 0$, 
the area can still be finite
\bnn
\int_0^2 x^{-\frac{1}{2}} \; dx = 2\, x^{\frac{1}{2}} \left. \frac{}{} \! \right|_0^2
    = 2\, \sqrt{x} \left. \frac{}{} \! \right|_0^2 
    = 2\,(\sqrt{2} - \sqrt{0}) = 2\,\sqrt{2} 
\enn
but again
\bnn
\int_0^2 x^{-1} \; dx = \int_0^2 \frac{1}{x} \; dx = \ln x \left. \frac{}{} \! \right|_0^2
    = \ln 2 - \underbrace{\ln 0}_{=-\infty} = \infty 
\enn \svs

And finally an exponential function
\bnn
\int_0^{\infty} e^{-x} \; dx = -e^{-x} \left. \frac{}{} \! \right|_0^{\infty}
    = -(\underbrace{e^{-\infty}}_{=0}-\underbrace{e^0}_{=1}) = 1 
\enn

\begin{figure}[!h]
    \centering
    \subfigure[$\int_1^{\infty} x^{-2} \, dx = 1$]{\epsfxsize=4.5cm \epsfbox{matlab/fig23_1a.eps}}
    \hspace*{0.5cm}
    \subfigure[$\int_0^2 x^{-\frac{1}{2}} \, dx = 2\,\sqrt{2}$]{\epsfxsize=4.5cm \epsfbox{matlab/fig23_1b.eps}} 
    \hspace*{0.5cm}
    \subfigure[$\int_0^{\infty} e^{-x} \, dx = 1$]{\epsfxsize=4.5cm \epsfbox{matlab/fig23_1c.eps}} \\ \vs
    \hspace*{0.5cm}
    \subfigure[$\int_1^{\infty} x^{-1} \, dx = \infty$]{\epsfxsize=4.5cm \epsfbox{matlab/fig23_1d.eps}}
    \hspace*{0.5cm}
    \subfigure[$\int_0^2 x^{-1} \, dx = \infty$]{\epsfxsize=4.5cm \epsfbox{matlab/fig23_1e.eps}} \svs
    \caption{Definite integrals that involve infinities}  \label{fig24}
\end{figure} \vs

\subsection{Functions with no Antiderivative}
As we have seen, it quite straightforward to calculate the derivatives of quite complicated
"monsters" of functions. On the other hand, it is much more difficult to find antiderivatives.
To make things worse there are certain functions with very important applications for which
an antiderivative does not exist, i.e. it cannot be expressed in terms of elementary functions.

One of these simple functions which do not have an antiderivative is $f(x)=e^{-x^2}$. This 
is very inconvenient because this function is the famous bell-shaped Gaussian which rules the
entire field of statistics, because the probability that an event occurs within a certain interval
of a parameter is given by area under this curve. This area unfortunately cannot be calculated
using a pocket calculator that has only elementary functions. The definite integral can be 
found numerically or looked up in tables, and it also has a name: the "error function" erf$(x)$
\bnn  
\mbox{erf}(x)=\frac{2}{\sqrt{\pi}} \, \int_0^x e^{-u^2} \, du  \qquad\qquad \mbox{note:}\qquad
\int_{-\infty}^{\infty} e^{-x^2}\,dx = \sqrt{\pi}
\enn  \svs

A second example of such a function with no antiderivative is the so-called "integral sine" Si$(x)$
\bnn 
\mbox{Si}(x)=\int_0^x \frac{\sin u}{u} \, du  \qquad\qquad \mbox{note:}\qquad
\int_{-\infty}^{\infty} \frac{\sin x}{x} \, dx = \pi
\enn  
\begin{figure}[t]
    \centerline{
    \subfigure[$\int_{-\infty}^{\infty} e^{-x^2}\,dx=\sqrt{\pi}$]{\epsfxsize=7cm \epsfbox{matlab/fig23_2a.eps}}
    \hspace*{0.5cm}
    \subfigure[$\int_{-\infty}^{\infty}{\frac{\sin x}{x}}\,dx=\pi$]{\epsfxsize=7cm \epsfbox{matlab/fig23_2b.eps}}} \svs 
    \caption{Definite integrals over functions with no antiderivatives}  \label{fig24}
\end{figure}




